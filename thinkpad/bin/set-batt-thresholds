#!/bin/bash
SMAPI_SYSFS=/sys/devices/platform/smapi
BATT_SYSFS=$SMAPI_SYSFS/BAT${3:-0}
# change thinkpad battery charge thresholds
if [[ $(id -u) != 0 ]]; then
	echo 'This script must be run as root!' >&2
	exit 1
fi

if [[ -z $1 || -z $2 ]]; then
	echo "Usage: $0 start stop [batn]" >&2
	exit 1
fi

if [[ ! -d $BATT_SYSFS ]]; then
	echo "Battery $3 doesn't exist!" >&2
	exit 1
fi

echo -n $1 > $BATT_SYSFS/start_charge_thresh
echo -n $2 > $BATT_SYSFS/stop_charge_thresh
